<!DOCTYPE html>
<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="Trauma Tetris, web prototype" content="">
        <meta name="Guillaume Ferron, Thomas Gargot" content="">

        <title>Trauma Prevent</title>

        <!-- Bootstrap core CSS -->
        <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom styles for this template -->
        <link href="css/scrolling-nav.css" rel="stylesheet">

        <!-- Font Awesome CDN (may break) #TODO -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

        <style>

            .form-title {
                padding-top:5%;
                text-align:center;
                color: #333;
            }
            .row {
                padding:4%;
                border-bottom: 1px #F1F1F1 solid;
            }
            hr {
                color: #F2F2F2
            }
            section {
                margin-top:-7%;
            }

        </style>

    </head>

    <body id="page-top">

        <!-- Navigation -->
        <header class="bg-primary text-white">
            <div class="container text-center">
                <h1>Preventing Post Traumatic Stress Disorder</h1>
                <h1>induced by trauma during the COVID pandemic</h1>
                <p class="lead">
                A simple brief digital intervention based on cognitive science
                </p>
            </div>
        </header>
        <div style='display:flex; justify-content: center;'>
            <button id="empty" style='align-self:flex-center; display:none;' class="btn btn-danger" onclick='remove_cookie()'>Reset form</button>
        </div>

        <section id="main">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 mx-auto">

                        <form id="q0" name="q0" method="POST">

                            <h4 class="form-title" style="margin-top:-10%;">Inclusion criteria</h3>
                            <hr>

                            <div class="form-group row">
                                <label class="col-2"></label> 
                                <div class="col-8">
                                    <input id="age" name="age" placeholder="Enter your age" type="number" min="0" max="120" aria-describedby="ageHelpBlock" required="required" class="form-control"> 
                                    <span id="ageHelpBlock" class="form-text text-muted">How old are you?</span>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-2"></label> 
                                <div class="col-8">
                                    <select id="suicidal" name="suicidal" class="form-control" aria-describedby="suicidalHelpBlock" required="required">
                                        <option disabled selected value> -- select an option -- </option>
                                        <option value="1">Yes</option>
                                        <option value="0">No</option>
                                    </select>
                                    <span id="suicidalHelpBlock" class="form-text text-muted">Do you have suicidal ideas?</span>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-2"></label> 
                                <div class="col-8">
                                    <select id="followsup" name="followsup" class="form-control" aria-describedby="followsupHelpBlock" required="required">
                                        <option disabled selected value> -- select an option -- </option>
                                        <option value="1">Yes</option>
                                        <option value="0">No</option>
                                    </select>
                                    <span id="followsupHelpBlock" class="form-text text-muted">Do you have psychological follows up?</span>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-2"></label> 
                                <div class="col-8">
                                    <select id="physfamiltrauma" name="physfamiltrauma" class="form-control" aria-describedby="physfamiltraumaHelpBlock" required="required">
                                        <option disabled selected value> -- select an option -- </option>
                                        <option value="1">Yes</option>
                                        <option value="0">No</option>
                                    </select>
                                    <span id="physfamiltraumaHelpBlock" class="form-text text-muted">Is the trauma related with a physical trauma done by someone in your family?</span>
                                </div>
                            </div>

                            <div style="border:none;padding-bottom:0;" class="form-group row" style="border:none;">
                                <label class="col-2"></label> 
                                <div class="col-8">
                                    <!-- Default unchecked -->
                                    <div class="custom-control custom-checkbox">
                                        <input required="required" name="privacy" type="checkbox" class="custom-control-input" id="defaultUnchecked">
                                        <label class="custom-control-label" for="defaultUnchecked">I agree to <a href="/privacy">Privacy Policy</a></label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="offset-4 col-8">
                                    <button name="submit" type="submit" class="btn btn-primary">Submit</button>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="py-5 bg-dark">
            <div class="container">
                <p class="m-0 text-center text-white"><a href="https://github.com/guillaumefe/proto-trauma-tetris">Source code</a></p>
            </div>
            <!-- /.container -->
        </footer>

        <!-- Bootstrap core JavaScript -->
        <script src="vendor/jquery/jquery.min.js"></script>
        <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

        <!-- Plugin JavaScript -->
        <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

        <!-- Custom JavaScript for this theme -->
        <script src="js/scrolling-nav.js"></script>

        <script>
            jQuery = $ //quick fix
        </script>

        <!-- Jquery cookie plugin -->
        <script src="jquery.cookie.js"></script>

        <script>

            let data = {}

$(window).bind("pageshow", function() {
    var form = $('form'); 
    // let the browser natively reset defaults
    form[0].reset();

    if (typeof $.cookie('data') === 'undefined'){
        //create cookie
        $.cookie("data", JSON.stringify(data), { expires : 1 });
    } else {
        data = JSON.parse($.cookie("data"));
    }
    for (key in data) {
        if (data.hasOwnProperty(key)) {
            document.q0[key].value = data[key]
        }
    }

});

if (typeof $.cookie('data') === 'undefined'){
    //create cookie
    $.cookie("data", JSON.stringify(data), { expires : 1 });
} else {
    data = JSON.parse($.cookie("data"));
}
for (key in data) {
    if (data.hasOwnProperty(key)) {
        document.q0[key].value = data[key]
    }
}

check_empty = function() {
    let count = 0
    for (key in data) {
        if (data[key]){
            count++
        }
    }
    if(count) {
        document.getElementById('empty').style.display = 'block'
    } else {
        document.getElementById('empty').style.display = 'none'
    }
}

remove_cookie = function() {
    $.removeCookie('data');
    for (key in data) {
        if (data.hasOwnProperty(key)) {
            document.q0[key].value = ''
        }
    }
    data = {}
    check_empty()
}

check_empty()

$('#q0').change(function(event){
    let el = event.target
    let name = el.name
    data[name] = el.value
    $.cookie("data", JSON.stringify(data), { expires : 1 });
    check_empty()
});

        </script>

    </body>

</html>
